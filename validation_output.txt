
Starting AI validation on target with custom dataset : /home/pansamic/Develop/Machine-Learning/cat-sound-cls/validation.npy... 
/home/pansamic/Develop/Embedded/STM32/STM32Cube-Repository/Packs/STMicroelectronics/X-CUBE-AI/8.1.0/Utilities/linux/stm32ai validate --name cat_sound_cls -m /home/pansamic/Develop/Machine-Learning/cat-sound-cls/cat_sound_classification_model.h5 --type keras --compression medium --verbosity 1 --workspace /tmp/mxAI_workspace165858977925569684394438734739054 --output /home/pansamic/.stm32cubemx/cat_sound_cls_output --allocate-inputs --allocate-outputs --mode stm32 --valinput /home/pansamic/Develop/Machine-Learning/cat-sound-cls/validation.npy --desc /dev/ttyACM0:921600  
Neural Network Tools for STM32 family v1.7.0 (stm.ai v8.1.0-19520) 
                                                         
Setting validation data... 
 loading file: /home/pansamic/Develop/Machine-Learning/cat-sound-cls/validation.npy 
 - samples are reshaped: (2600,) -> (1, 1, 1, 2600) 
 I[1]: (1, 1, 1, 2600)/float32, min/max=[-3.088, 13.829], mean/std=[2.887, 5.244], input_0 
 No output/reference samples are provided 
fatal: not a git repository (or any of the parent directories): .git 
  
 Exec/report summary (validate) 
 ----------------------------------------------------------------------------------------------------------------- 
 model file         :   /home/pansamic/Develop/Machine-Learning/cat-sound-cls/cat_sound_classification_model.h5    
 type               :   keras                                                                                      
 c_name             :   cat_sound_cls                                                                              
 compression        :   medium                                                                                     
 options            :   allocate-inputs, allocate-outputs                                                          
 optimization       :   balanced                                                                                   
 workspace dir      :   /tmp/mxAI_workspace165858977925569684394438734739054                                       
 output dir         :   /home/pansamic/.stm32cubemx/cat_sound_cls_output                                           
 vinput files       :   /home/pansamic/Develop/Machine-Learning/cat-sound-cls/validation.npy                       
 model_fmt          :   float                                                                                      
 model_name         :   cat_sound_classification_model                                                             
 model_hash         :   55124f771d9f1dde485794e12f9a2483                                                           
 params #           :   700,042 items (2.67 MiB)                                                                   
 ----------------------------------------------------------------------------------------------------------------- 
 input 1/1          :   'input_0' (domain:activations/**default**)                                                 
                    :   2600 items, 10.16 KiB, ai_float, float, (1,2600)                                           
 output 1/1         :   'dense_2' (domain:activations/**default**)                                                 
                    :   10 items, 40 B, ai_float, float, (1,10)                                                    
 macc               :   700,576                                                                                    
 weights (ro)       :   356,008 B (347.66 KiB) (1 segment) / -2,444,160(-87.3%) vs float model                     
 activations (rw)   :   11,424 B (11.16 KiB) (1 segment) *                                                         
 ram (total)        :   11,424 B (11.16 KiB) = 11,424 + 0 + 0                                                      
 ----------------------------------------------------------------------------------------------------------------- 
 (*) 'input'/'output' buffers can be used from the activations buffer 
                                                         
Running the STM AI c-model (AI RUNNER)...(name=cat_sound_cls, mode=stm32) 
                                                         
 STM Proto-buffer protocol 3.0 (SERIAL:/dev/ttyACM0:921600:connected) ['cat_sound_cls'] 
                                                         
  Summary "cat_sound_cls" - ['cat_sound_cls'] 
  --------------------------------------------------------------------------------------------- 
  inputs/ouputs      :   1/1 
  input_1            :   input_1, (1,1,1,2600), float32, 10,400 bytes, in activations buffer 
  output_1           :   output_1, (1,1,1,10), float32, 40 bytes, in activations buffer 
  n_nodes            :   6 
  compile_datetime   :   Mar  7 2024 01:16:50 
  activations        :   11424 
  weights            :   356008 
  macc               :   700576 
  --------------------------------------------------------------------------------------------- 
  runtime            :   STM.AI(/gcc) 8.1.0 (Tools 8.1.0) - Protocol 3.0 
  capabilities       :   IO_ONLY, PER_LAYER, PER_LAYER_WITH_DATA 
  device             :   0x413 - STM32F4x @168/168 
                         fpu,art_lat=5,art_prefetch,art_icache,art_dcache 
                                                         
  STM.AI Profiling results v1.2 - cat_sound_cls 
  --------------------------------------------------------------- 
  nb sample(s)    :   1 
  duration        :   37.403ms by sample (37.403/37.403/0.000) 
  macc            :   700576 
  cycles/MACC     :   8.97 
  counter         :   [6,283,722] 
  --------------------------------------------------------------- 
  HOST duration   :   0.376s (total) 
  --------------------------------------------------------------- 
                                                         
   Inference time per node 
   -------------------------------------------------------------------------------------- 
   c_id    m_id   type            dur (ms)     %         counters            name 
   -------------------------------------------------------------------------------------- 
   0       0      Dense (0x104)       35.496     94.9%   [      5,963,397]   ai_node_0 
   1       0      NL (0x107)           0.024      0.1%   [          3,960]   ai_node_1 
   2       1      Dense (0x104)        1.785      4.8%   [        299,920]   ai_node_2 
   3       1      NL (0x107)           0.013      0.0%   [          2,168]   ai_node_3 
   4       2      Dense (0x104)        0.070      0.2%   [         11,691]   ai_node_4 
   5       2      NL (0x107)           0.015      0.0%   [          2,586]   ai_node_5 
   -------------------------------------------------------------------------------------- 
   total                              37.403             [      6,283,722] 
   -------------------------------------------------------------------------------------- 
                                                         
   Statistic per tensor 
   ------------------------------------------------------------------------------- 
   tensor   shape/type                  min      max     mean      std name 
   ------------------------------------------------------------------------------- 
   I.0      (1,1,1,2600)/float32     -3.088   13.829    2.887    5.244 input_1 
   O.0      (1,1,1,10)/float32        0.000    1.000    0.100    0.300 output_1 
   ------------------------------------------------------------------------------- 
                                                         
Running the Keras model... 
                                                        
Saving validation data... 
 output directory: /home/pansamic/.stm32cubemx/cat_sound_cls_output 
 creating /home/pansamic/.stm32cubemx/cat_sound_cls_output/cat_sound_cls_val_io.npz 
 m_outputs_1: (1, 1, 1, 10)/float32, min/max=[0.000, 1.000], mean/std=[0.100, 0.300], dense_2 
 c_outputs_1: (1, 1, 1, 10)/float32, min/max=[0.000, 1.000], mean/std=[0.100, 0.300], dense_2 
                                                        
Computing the metrics... 
                                                        
 Cross accuracy report #1 (reference vs C-model) 
 ---------------------------------------------------------------------------------------------------- 
 notes: - the output of the reference model is used as ground truth/reference value 
        - 1 samples (10 items per sample) 
                                                        
  acc=100.00%, rmse=0.000000000, mae=0.000000000, l2r=0.000000000, nse=100.00%, cos=100.00% 
                                                        
  10 classes (1 samples) 
  ---------------------------------------------------------- 
  C0        1    .    .    .    .    .    .    .    .    . 
  C1        .    0    .    .    .    .    .    .    .    . 
  C2        .    .    0    .    .    .    .    .    .    . 
  C3        .    .    .    0    .    .    .    .    .    . 
  C4        .    .    .    .    0    .    .    .    .    . 
  C5        .    .    .    .    .    0    .    .    .    . 
  C6        .    .    .    .    .    .    0    .    .    . 
  C7        .    .    .    .    .    .    .    0    .    . 
  C8        .    .    .    .    .    .    .    .    0    . 
  C9        .    .    .    .    .    .    .    .    .    0 
                                                        
 Evaluation report (summary) 
 -------------------------------------------------------------------------------------------------------------------------------------------------- 
 Output       acc       rmse        mae         l2r         mean         std         nse         cos         tensor 
 -------------------------------------------------------------------------------------------------------------------------------------------------- 
 X-cross #1   100.00%   0.0000000   0.0000000   0.0000000   -0.0000000   0.0000000   1.0000000   1.0000000   dense_2, ai_float, (1,10), m_id=[2] 
 -------------------------------------------------------------------------------------------------------------------------------------------------- 
                                                        
  acc  : Classification accuracy (all classes) 
  rmse : Root Mean Squared Error 
  mae  : Mean Absolute Error 
  l2r  : L2 relative error 
  nse  : Nash-Sutcliffe efficiency criteria 
  cos  : COsine Similarity 
                                                        
Creating txt report file /home/pansamic/.stm32cubemx/cat_sound_cls_output/cat_sound_cls_validate_report.txt 
elapsed time (validate): 3.096s 
Validation ended